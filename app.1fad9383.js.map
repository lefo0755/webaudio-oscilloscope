{"version":3,"sources":["index.js","tools/canvas_tools.js","app.js"],"names":["_initCvs","ctx","width","height","fillStyle","DEFAULT_FILL","strokeStyle","DEFAULT_STROKE","_primer","fillRect","HLINE_COLOR","beginPath","moveTo","lineTo","stroke","_drawRawOsc","data","i","length","x","y","MediaStreamOscilloscope","mediaStream","canvasElement","audioDest","analyzerFFT","canvasInitFunction","drawingPrimerFunction","createAudioContext","src","createMediaStreamSource","Oscilloscope","getUserMedia","constraints","Promise","resolve","navigator","mediaDevices","then","catch","webkitGetUserMedia","mozGetUserMedia","audioContext","audioSource","actx","FFT","cvs","init","_ct","primer","paused","anl","createAnalyser","dest","fftSize","connect","WIDTH","HEIGHT","u8ar","Uint8Array","cctx","getContext","draw","requestAnimationFrame","clearRect","getByteTimeDomainData","start","pause","reset","fill","window","AudioContext","webkitAudioContext","stats","document","querySelector","fancyGraph","backstrokeStyle","j","startOsc","audio","stream","classList","add","remove","innerHTML","osc","addEventListener"],"mappings":"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","file":"app.1fad9383.js","sourceRoot":"..\\example","sourcesContent":["\"use strict\";\nimport * as _ct from \"./tools/canvas_tools\";\nfunction Oscilloscope(audioContext, audioSource, canvasElement, audioDest = null, analyzerFFT = 2048, canvasInitFunction = null, drawingPrimerFunction = null){\n        this.actx   = audioContext;\n        this.FFT    = analyzerFFT;\n        this.cvs    = canvasElement;\n        this.init   = canvasInitFunction    || _ct._initCvs;\n        this.primer = drawingPrimerFunction || _ct._primer;\n        this.paused = false;\n        this.anl    = this.actx.createAnalyser();\n        this.ctx    = audioContext;\n        this.src    = audioSource;\n        this.dest   = audioDest;\n        // Configure Analyzer\n        this.anl.fftSize = this.FFT;\n        this.src.connect(this.anl);\n        if(this.dest) this.anl.connect(this.dest);\n        // Set up Canvas\n        let {width = 300, height = 150} = this.cvs;\n        this.WIDTH  = width;\n        this.HEIGHT = height;\n        this.u8ar = new Uint8Array(this.FFT);\n        this.cctx = this.cvs.getContext(\"2d\");\n        this.init(this.cctx,this.WIDTH,this.HEIGHT);\n        this.draw = () =>{\n            if(!this.paused) requestAnimationFrame(this.draw);\n            this.cctx.clearRect(0 , 0, this.WIDTH, this.HEIGHT);\n            this.primer(this.cctx, this.WIDTH, this.HEIGHT);\n            this.anl.getByteTimeDomainData(this.u8ar);\n            _ct._drawRawOsc(this.cctx, this.u8ar, this.WIDTH, this.HEIGHT);\n        }\n        this.start = () => {\n            this.paused = false;\n            this.draw();\n        }\n        this.pause = () =>{\n            this.paused = true;\n        }\n        this.reset = () =>{\n            this.paused = true;\n            requestAnimationFrame(()=>{\n                this.u8ar = new Uint8Array(this.FFT).fill(0);\n                this.cctx.clearRect(0 , 0, this.WIDTH, this.HEIGHT);\n                this.primer(this.cctx, this.WIDTH, this.HEIGHT);\n                _ct._drawRawOsc(this.cctx, this.u8ar, this.WIDTH, this.HEIGHT);\n            });\n        }\n}\n\nfunction createAudioContext(){\n    return new (window.AudioContext || window.webkitAudioContext)();\n}\n\nfunction MediaStreamOscilloscope(mediaStream, canvasElement, audioDest = null, analyzerFFT = 2048, canvasInitFunction = null, drawingPrimerFunction = null){\n    let ctx = createAudioContext();\n    let src = ctx.createMediaStreamSource(mediaStream);\n    return new Oscilloscope(ctx, src, canvasElement, audioDest, analyzerFFT, canvasInitFunction, drawingPrimerFunction);\n}\n\nfunction getUserMedia(constraints){\n    return new Promise((resolve)=>{\n        if(navigator && navigator.mediaDevices && navigator.mediaDevices.getUserMedia){\n            navigator.mediaDevices.getUserMedia(constraints).then(resolve).catch(()=>resolve(null));\n        }\n        else if(navigator.getUserMedia){\n            navigator.getUserMedia(constraints, resolve, ()=>resolve(null));\n        }\n        else if(navigator.webkitGetUserMedia){\n            navigator.webkitGetUserMedia(constraints, resolve, ()=>resolve(null));\n        }\n        else if(navigator.mozGetUserMedia){\n            navigator.mozGetUserMedia(constraints, resolve, ()=>resolve(null));\n        }\n        else resolve(null);\n    });\n}\nexport {\n    Oscilloscope,\n    MediaStreamOscilloscope,\n    createAudioContext,\n    getUserMedia\n}","const DEFAULT_FILL   = \"#111111\";\nconst DEFAULT_STROKE = \"#11ff11\"; \nconst HLINE_COLOR    = \"#555555\";\nfunction _initCvs(ctx, width, height){\n    ctx.fillStyle   = DEFAULT_FILL;\n    ctx.strokeStyle = DEFAULT_STROKE;\n}\nfunction _primer(ctx, width, height){\n    ctx.fillRect(0,0,width,height);\n    ctx.strokeStyle = HLINE_COLOR;\n    ctx.beginPath();\n    ctx.moveTo(0, height / 2);\n    ctx.lineTo(width, height / 2);\n    ctx.stroke();\n    ctx.strokeStyle = DEFAULT_STROKE;\n}\nfunction _drawRawOsc(ctx,data,width,height){\n    ctx.beginPath();\n    for(let i=0; i < data.length; i++){\n        let x = i * (width * 1.0 / data.length); // need to fix x\n        let v = data[i] / 128.0;\n        let y = v * height / 2;\n        if(i === 0) ctx.moveTo(x,y);\n        else ctx.lineTo(x,y);\n    }\n    ctx.stroke();\n}\nexport {\n    _initCvs,\n    _primer,\n    _drawRawOsc\n}","import {MediaStreamOscilloscope, getUserMedia} from \"../dist/index\";\r\n\r\nlet stats = document.querySelector(\".status\");\r\nlet cvs   = cvs = document.querySelector(\".cvs\");\r\n\r\nfunction fancyGraph(ctx,width,height){\r\n    let backstrokeStyle = ctx.strokeStyle;\r\n    ctx.strokeStyle = \"#444\";\r\n    ctx.fillRect(0,0,width,height);\r\n    ctx.beginPath();\r\n    for(let i=0; i<width; i+=10){\r\n        ctx.moveTo(i,0);\r\n        ctx.lineTo(i,height);\r\n    }\r\n    for(let j=0; j<height; j+=10){\r\n        ctx.moveTo(0,j);\r\n        ctx.lineTo(width,j);\r\n    }\r\n    ctx.stroke();\r\n    ctx.strokeStyle = backstrokeStyle;\r\n}\r\nfunction startOsc(){\r\n    getUserMedia({audio: true})\r\n        .then(stream=>{\r\n            if(!stream) {\r\n                stats.classList.add(\"err\");\r\n                stats.classList.remove(\"success\");\r\n                stats.innerHTML = \"Could not Access microphone\";\r\n                return false;\r\n            }\r\n            stats.classList.add(\"success\");\r\n            stats.classList.remove(\"error\");\r\n            stats.innerHTML = \"Listening to your microphone, Try saying something\";\r\n            let osc = new MediaStreamOscilloscope(stream, cvs, null, 2048, null, fancyGraph);\r\n            osc.start();\r\n            document.querySelector(\".btn.pause\").addEventListener(\"click\",()=>{\r\n                stats.innerHTML = \"Oscilloscope Paused\";\r\n                osc.pause();\r\n            });\r\n            document.querySelector(\".btn.reset\").addEventListener(\"click\",()=>{\r\n                stats.innerHTML = \"Oscilloscope Reset\";\r\n                osc.reset();\r\n            });\r\n        });\r\n}\r\ndocument.querySelector(\".start\").addEventListener(\"click\",startOsc);"]}